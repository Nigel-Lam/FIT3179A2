{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Pie Chart of world Uranium Deposits",
  "width": "container",
  "title": {
    "text": {"expr": "chart_selection == 'Deposits' ? 'World Percentage of Uranium Deposits' : 'World Percentage of Uranium Exports'"}, 
    "frame": "group", 
    "anchor": "middle", 
    "fontSize": 15, 
    "fontWeight": "bold"},
  "data": {
    "name": "source_1",
    "url": "https://raw.githubusercontent.com/Nigel-Lam/FIT3179A2/refs/heads/main/Datasets/UraniumReservesExport.csv",
    "format": {"type": "csv"}
  },
  "mark": {"type": "arc", "tooltip": true},
  "encoding": {
    "theta": {"field": "selected_tonnes", "type": "quantitative", "stack": "normalize"},
    "color": {"field": "Country", "type": "nominal", "scale": {"scheme": "category20"}},
    "opacity": {
      "condition": {"param": "country_display", "value": 1},
      "value": 0.2
    },
    "tooltip": [
      {"title": "Country", "field": "Country", "type": "nominal"},
      {"title": "Uranium Deposit (t)", "field": "tonnes", "type": "quantitative"},
      {"title": "World Percentage of Uranium Deposit", "field": "Percentage_reserves", "type": "nominal"},
      {"title": "Uranium Export (t)", "field": "Export", "type": "quantitative"},
      {"title": "World Percentage of Uranium Export", "field": "Percentage_exports", "type": "nominal"}
    ]
  },
  "params": [
    {
      "name": "country_display",
      "select": {"type": "point", "fields": ["Country"]},
      "bind": "legend"
    },
    {
      "name": "chart_selection",
      "bind": {
        "input": "select",
        "options": ["Deposits", "Exports"],
        "name": "View "
      },
      "value": "Deposits"
    }
  ],
  "transform": [
    {
      "calculate": "chart_selection == 'Deposits' ? datum.tonnes : datum.Export",
      "as": "selected_tonnes"
    },
    {
      "calculate": "chart_selection == 'Deposits' ? datum.Percentage_reserves : datum.Percentage_exports",
      "as": "selected_percentage"
    },
    {
      "filter": "chart_selection == 'Deposits' || datum.Export != null"
    }
    ],
  "config": {}
}
